2026-02-05 14:14:43.198882: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2026-02-05 14:14:43.284416: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2026-02-05 14:14:45.371522: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
/home/luis/.local/lib/python3.10/site-packages/tensorflow_hub/__init__.py:61: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import parse_version
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1770318890.065686   63379 gpu_device.cc:2020] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 3582 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 3060 Laptop GPU, pci bus id: 0000:01:00.0, compute capability: 8.6
2026-02-05 14:15:06.808071: I external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:473] Loaded cuDNN version 91002
Cargando modelo VGGish desde TensorFlow Hub...
Modelo VGGish cargado correctamente.

======================================================================
CONFIGURACIÓN
======================================================================
Dispositivo: cuda
Duración de segmento: 50.0s
Solapamiento (fracción): 0.0
K-Folds: 10
Semilla: 42
Usar cache: True
Modelos se guardarán en: /home/luis/projects/tesis/audio/soldadura/50seg/models/k10_overlap_0.0/
[TIMER] Cargar CSVs (train/test)...
[TIMER] Cargar CSVs (train/test): 0.01s (0.00min)

Total de segmentos: 389
Sesiones únicas: 335
[TIMER] Embeddings VGGish (cache/compute)...

Extrayendo embeddings VGGish de todos los segmentos...
[TIMER] Calcular embeddings VGGish (compute)...
  Procesando 0/389...
  Procesando 100/389...
  Procesando 200/389...
  Procesando 300/389...
[TIMER] Calcular embeddings VGGish (compute): 1361.84s (22.70min)
[TIMER] Guardar cache embeddings VGGish...
[TIMER] Guardar cache embeddings VGGish: 0.13s (0.00min)
  [CACHE] Guardados 389 embeddings en cache (/home/luis/projects/tesis/audio/soldadura/50seg/embeddings_cache/vggish_embeddings_50.0s_overlap_0.0.pkl)
[TIMER] Embeddings VGGish (cache/compute): 1361.97s (22.70min)
Embeddings extraídos: 389
Tiempo extraccion VGGish: 1361.84s (22.70min)

======================================================================
FASE 1: ENTRENAMIENTO DE 10 MODELOS (StratifiedGroupKFold)
======================================================================
[INFO] Usando StratifiedGroupKFold

Fold 1/10
  Train: 347 segmentos (302 sesiones)
  Val: 42 segmentos (33 sesiones)
[TIMER] Entrenar fold 1/10...
  Fold 1: Plate=0.9524 | Electrode=0.8571 | Current=0.9762 | Guardado: model_fold_0.pth
[TIMER] Entrenar fold 1/10: 147.98s (2.47min)

Fold 2/10
  Train: 350 segmentos (301 sesiones)
  Val: 39 segmentos (34 sesiones)
[TIMER] Entrenar fold 2/10...
  Fold 2: Plate=0.9231 | Electrode=0.9487 | Current=0.9744 | Guardado: model_fold_1.pth
[TIMER] Entrenar fold 2/10: 42.17s (0.70min)

Fold 3/10
  Train: 349 segmentos (303 sesiones)
  Val: 40 segmentos (32 sesiones)
[TIMER] Entrenar fold 3/10...
  Fold 3: Plate=0.9000 | Electrode=0.9250 | Current=0.9500 | Guardado: model_fold_2.pth
[TIMER] Entrenar fold 3/10: 46.18s (0.77min)

Fold 4/10
  Train: 351 segmentos (301 sesiones)
  Val: 38 segmentos (34 sesiones)
[TIMER] Entrenar fold 4/10...
  Fold 4: Plate=0.9211 | Electrode=1.0000 | Current=1.0000 | Guardado: model_fold_3.pth
[TIMER] Entrenar fold 4/10: 76.64s (1.28min)

Fold 5/10
  Train: 346 segmentos (301 sesiones)
  Val: 43 segmentos (34 sesiones)
[TIMER] Entrenar fold 5/10...
  Fold 5: Plate=0.8372 | Electrode=0.9535 | Current=0.9767 | Guardado: model_fold_4.pth
[TIMER] Entrenar fold 5/10: 5.89s (0.10min)

Fold 6/10
  Train: 353 segmentos (301 sesiones)
  Val: 36 segmentos (34 sesiones)
[TIMER] Entrenar fold 6/10...
  Fold 6: Plate=0.9722 | Electrode=0.9722 | Current=1.0000 | Guardado: model_fold_5.pth
[TIMER] Entrenar fold 6/10: 8.50s (0.14min)

Fold 7/10
  Train: 352 segmentos (301 sesiones)
  Val: 37 segmentos (34 sesiones)
[TIMER] Entrenar fold 7/10...
  Fold 7: Plate=0.9730 | Electrode=1.0000 | Current=1.0000 | Guardado: model_fold_6.pth
[TIMER] Entrenar fold 7/10: 5.09s (0.08min)

Fold 8/10
  Train: 353 segmentos (302 sesiones)
  Val: 36 segmentos (33 sesiones)
[TIMER] Entrenar fold 8/10...
  Fold 8: Plate=0.9167 | Electrode=0.9167 | Current=0.9722 | Guardado: model_fold_7.pth
[TIMER] Entrenar fold 8/10: 7.14s (0.12min)

Fold 9/10
  Train: 351 segmentos (301 sesiones)
  Val: 38 segmentos (34 sesiones)
[TIMER] Entrenar fold 9/10...
  Fold 9: Plate=0.9474 | Electrode=1.0000 | Current=1.0000 | Guardado: model_fold_8.pth
[TIMER] Entrenar fold 9/10: 5.88s (0.10min)

Fold 10/10
  Train: 349 segmentos (302 sesiones)
  Val: 40 segmentos (33 sesiones)
[TIMER] Entrenar fold 10/10...
  Fold 10: Plate=0.8750 | Electrode=0.9500 | Current=1.0000 | Guardado: model_fold_9.pth
[TIMER] Entrenar fold 10/10: 5.62s (0.09min)

Tiempo de entrenamiento puro: 319.35s (5.32min)

======================================================================
FASE 2: EVALUACIÓN DEL ENSEMBLE (Soft Voting)
======================================================================
[TIMER] Cargar modelos del ensemble...
Cargados 10 modelos del ensemble
[TIMER] Cargar modelos del ensemble: 0.18s (0.00min)
[TIMER] Evaluación ensemble (Soft Voting)...
Evaluando ensemble en todo el dataset...
[TIMER] Evaluación ensemble (Soft Voting): 0.24s (0.00min)

======================================================================
RESULTADOS FINALES
======================================================================

Métricas individuales por fold (promedio):
  Plate:     0.9218
  Electrode: 0.9523
  Current:   0.9850

Métricas del ENSEMBLE (Soft Voting, 10 modelos):
  Plate:     Acc=0.9949 | F1=0.9949 | Prec=0.9949 | Rec=0.9949
  Electrode: Acc=0.9974 | F1=0.9974 | Prec=0.9975 | Rec=0.9974
  Current:   Acc=0.9974 | F1=0.9974 | Prec=0.9974 | Rec=0.9974

Mejora del Ensemble vs Promedio Individual:
  Plate:     +0.0731
  Electrode: +0.0451
  Current:   +0.0125

======================================================================
REPORTES DE CLASIFICACIÓN
======================================================================

--- Plate Thickness ---
              precision    recall  f1-score   support

  Placa_12mm       0.98      1.00      0.99       130
   Placa_3mm       1.00      0.99      1.00       138
   Placa_6mm       1.00      0.99      1.00       121

    accuracy                           0.99       389
   macro avg       0.99      0.99      0.99       389
weighted avg       0.99      0.99      0.99       389


--- Electrode Type ---
              precision    recall  f1-score   support

       E6010       1.00      1.00      1.00        54
       E6011       1.00      0.99      1.00       154
       E6013       1.00      1.00      1.00       118
       E7018       0.98      1.00      0.99        63

    accuracy                           1.00       389
   macro avg       1.00      1.00      1.00       389
weighted avg       1.00      1.00      1.00       389


--- Type of Current ---
              precision    recall  f1-score   support

          AC       0.99      1.00      1.00       156
          DC       1.00      1.00      1.00       233

    accuracy                           1.00       389
   macro avg       1.00      1.00      1.00       389
weighted avg       1.00      1.00      1.00       389


======================================================================
MATRICES DE CONFUSIÓN
======================================================================

Plate Thickness:
[[130   0   0]
 [  1 137   0]
 [  1   0 120]]
Clases: ['Placa_12mm' 'Placa_3mm' 'Placa_6mm']

Electrode Type:
[[ 54   0   0   0]
 [  0 153   0   1]
 [  0   0 118   0]
 [  0   0   0  63]]
Clases: ['E6010' 'E6011' 'E6013' 'E7018']

Type of Current:
[[156   0]
 [  1 232]]
Clases: ['AC' 'DC']

Tiempo de ejecución: 1562.41s (26.04min / 0.43h)

Resultados guardados en: /home/luis/projects/tesis/audio/soldadura/50seg/results.json (entrada #2)
Modelos guardados en: /home/luis/projects/tesis/audio/soldadura/50seg/models/k10_overlap_0.0/
