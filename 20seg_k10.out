2026-02-05 14:13:49.842256: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2026-02-05 14:13:49.945482: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2026-02-05 14:13:51.003878: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
/home/luis/.local/lib/python3.10/site-packages/tensorflow_hub/__init__.py:61: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import parse_version
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
I0000 00:00:1770318834.398808   62710 gpu_device.cc:2020] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 3582 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 3060 Laptop GPU, pci bus id: 0000:01:00.0, compute capability: 8.6
Cargando modelo VGGish desde TensorFlow Hub...
Modelo VGGish cargado correctamente.

======================================================================
CONFIGURACIÓN
======================================================================
Dispositivo: cuda
Duración de segmento: 20.0s
Solapamiento (fracción): 0.0
K-Folds: 10
Semilla: 42
Usar cache: True
Modelos se guardarán en: /home/luis/projects/tesis/audio/soldadura/20seg/models/k10_overlap_0.0/
[TIMER] Cargar CSVs (train/test)...
[TIMER] Cargar CSVs (train/test): 0.01s (0.00min)

Total de segmentos: 1441
Sesiones únicas: 335
[TIMER] Embeddings VGGish (cache/compute)...

Extrayendo embeddings VGGish de todos los segmentos...
[TIMER] Cargar cache embeddings VGGish...
[TIMER] Cargar cache embeddings VGGish: 0.03s (0.00min)
  [CACHE] Cargando 1441 embeddings desde cache (/home/luis/projects/tesis/audio/soldadura/20seg/embeddings_cache/vggish_embeddings_20.0s_overlap_0.0.pkl)
[TIMER] Embeddings VGGish (cache/compute): 0.03s (0.00min)
Embeddings extraídos: 1441

======================================================================
FASE 1: ENTRENAMIENTO DE 10 MODELOS (StratifiedGroupKFold)
======================================================================
[INFO] Usando StratifiedGroupKFold

Fold 1/10
  Train: 1304 segmentos (303 sesiones)
  Val: 137 segmentos (32 sesiones)
[TIMER] Entrenar fold 1/10...
  Fold 1: Plate=0.8102 | Electrode=0.8321 | Current=0.9051 | Guardado: model_fold_0.pth
[TIMER] Entrenar fold 1/10: 24.42s (0.41min)

Fold 2/10
  Train: 1289 segmentos (300 sesiones)
  Val: 152 segmentos (35 sesiones)
[TIMER] Entrenar fold 2/10...
  Fold 2: Plate=0.7829 | Electrode=0.8553 | Current=0.9145 | Guardado: model_fold_1.pth
[TIMER] Entrenar fold 2/10: 26.02s (0.43min)

Fold 3/10
  Train: 1309 segmentos (302 sesiones)
  Val: 132 segmentos (33 sesiones)
[TIMER] Entrenar fold 3/10...
  Fold 3: Plate=0.8106 | Electrode=0.8106 | Current=0.9318 | Guardado: model_fold_2.pth
[TIMER] Entrenar fold 3/10: 290.56s (4.84min)

Fold 4/10
  Train: 1310 segmentos (301 sesiones)
  Val: 131 segmentos (34 sesiones)
[TIMER] Entrenar fold 4/10...
  Fold 4: Plate=0.7863 | Electrode=0.8092 | Current=0.9084 | Guardado: model_fold_3.pth
[TIMER] Entrenar fold 4/10: 328.09s (5.47min)

Fold 5/10
  Train: 1309 segmentos (302 sesiones)
  Val: 132 segmentos (33 sesiones)
[TIMER] Entrenar fold 5/10...
  Fold 5: Plate=0.8106 | Electrode=0.8106 | Current=0.8561 | Guardado: model_fold_4.pth
[TIMER] Entrenar fold 5/10: 167.33s (2.79min)

Fold 6/10
  Train: 1272 segmentos (300 sesiones)
  Val: 169 segmentos (35 sesiones)
[TIMER] Entrenar fold 6/10...
  Fold 6: Plate=0.6923 | Electrode=0.8639 | Current=0.8757 | Guardado: model_fold_5.pth
[TIMER] Entrenar fold 6/10: 88.77s (1.48min)

Fold 7/10
  Train: 1304 segmentos (302 sesiones)
  Val: 137 segmentos (33 sesiones)
[TIMER] Entrenar fold 7/10...
  Fold 7: Plate=0.8540 | Electrode=0.8613 | Current=0.8613 | Guardado: model_fold_6.pth
[TIMER] Entrenar fold 7/10: 157.21s (2.62min)

Fold 8/10
  Train: 1282 segmentos (301 sesiones)
  Val: 159 segmentos (34 sesiones)
[TIMER] Entrenar fold 8/10...
  Fold 8: Plate=0.6855 | Electrode=0.8239 | Current=0.8931 | Guardado: model_fold_7.pth
[TIMER] Entrenar fold 8/10: 149.02s (2.48min)

Fold 9/10
  Train: 1299 segmentos (302 sesiones)
  Val: 142 segmentos (33 sesiones)
[TIMER] Entrenar fold 9/10...
  Fold 9: Plate=0.7394 | Electrode=0.8944 | Current=0.9296 | Guardado: model_fold_8.pth
[TIMER] Entrenar fold 9/10: 289.56s (4.83min)

Fold 10/10
  Train: 1291 segmentos (302 sesiones)
  Val: 150 segmentos (33 sesiones)
[TIMER] Entrenar fold 10/10...
  Fold 10: Plate=0.7867 | Electrode=0.8000 | Current=0.8533 | Guardado: model_fold_9.pth
[TIMER] Entrenar fold 10/10: 199.14s (3.32min)

Tiempo de entrenamiento puro: 1567.83s (26.13min)

======================================================================
FASE 2: EVALUACIÓN DEL ENSEMBLE (Soft Voting)
======================================================================
[TIMER] Cargar modelos del ensemble...
Cargados 10 modelos del ensemble
[TIMER] Cargar modelos del ensemble: 0.48s (0.01min)
[TIMER] Evaluación ensemble (Soft Voting)...
Evaluando ensemble en todo el dataset...
[TIMER] Evaluación ensemble (Soft Voting): 9.17s (0.15min)

======================================================================
RESULTADOS FINALES
======================================================================

Métricas individuales por fold (promedio):
  Plate:     0.7759
  Electrode: 0.8361
  Current:   0.8929

Métricas del ENSEMBLE (Soft Voting, 10 modelos):
  Plate:     Acc=0.8668 | F1=0.8697 | Prec=0.9034 | Rec=0.8668
  Electrode: Acc=0.8910 | F1=0.8917 | Prec=0.9139 | Rec=0.8910
  Current:   Acc=0.9042 | F1=0.9047 | Prec=0.9218 | Rec=0.9042

Mejora del Ensemble vs Promedio Individual:
  Plate:     +0.0909
  Electrode: +0.0549
  Current:   +0.0113

======================================================================
REPORTES DE CLASIFICACIÓN
======================================================================

--- Plate Thickness ---
              precision    recall  f1-score   support

  Placa_12mm       1.00      0.78      0.88       482
   Placa_3mm       0.73      1.00      0.84       507
   Placa_6mm       1.00      0.81      0.89       452

    accuracy                           0.87      1441
   macro avg       0.91      0.86      0.87      1441
weighted avg       0.90      0.87      0.87      1441


--- Electrode Type ---
              precision    recall  f1-score   support

       E6010       1.00      0.77      0.87       225
       E6011       0.79      1.00      0.88       592
       E6013       1.00      0.82      0.90       417
       E7018       1.00      0.85      0.92       207

    accuracy                           0.89      1441
   macro avg       0.95      0.86      0.89      1441
weighted avg       0.91      0.89      0.89      1441


--- Type of Current ---
              precision    recall  f1-score   support

          AC       0.82      1.00      0.90       613
          DC       1.00      0.83      0.91       828

    accuracy                           0.90      1441
   macro avg       0.91      0.92      0.90      1441
weighted avg       0.92      0.90      0.90      1441


======================================================================
MATRICES DE CONFUSIÓN
======================================================================

Plate Thickness:
[[377 105   0]
 [  0 507   0]
 [  0  87 365]]
Clases: ['Placa_12mm' 'Placa_3mm' 'Placa_6mm']

Electrode Type:
[[174  51   0   0]
 [  0 592   0   0]
 [  0  74 343   0]
 [  0  32   0 175]]
Clases: ['E6010' 'E6011' 'E6013' 'E7018']

Type of Current:
[[613   0]
 [138 690]]
Clases: ['AC' 'DC']

Tiempo de ejecución: 1577.14s (26.29min / 0.44h)

Resultados guardados en: /home/luis/projects/tesis/audio/soldadura/20seg/results.json (entrada #3)
Modelos guardados en: /home/luis/projects/tesis/audio/soldadura/20seg/models/k10_overlap_0.0/
